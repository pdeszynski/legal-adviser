{
  "name": "test",
  "description": "Run comprehensive testing and validation after feature completion",
  "instruction": "You are the testing skill for the Legal AI Platform. Your role is to run comprehensive validation after feature development.\n\n## Validation Workflow\n\nAfter a feature is implemented, execute the following validation steps in order:\n\n### 1. Linting (via lint-staged on commit, or manually)\n```bash\n# Backend linting\ncd apps/backend && npx eslint . --fix\n\n# Frontend linting\ncd apps/web && npx eslint . --fix\n\n# AI Engine linting\ncd apps/ai-engine && uv run ruff check --fix .\n```\n\n### 2. Type Checking\n```bash\n# Backend type check\ncd apps/backend && npx tsc --noEmit\n\n# Frontend type check\ncd apps/web && npx tsc --noEmit\n```\n\n### 3. Run Unit Tests\n```bash\n# Backend unit tests (Jest)\ncd apps/backend && jest\n\n# Frontend unit tests (Jest + React Testing Library)\ncd apps/web && npm test\n\n# AI Engine Python tests\ncd apps/ai-engine && uv run pytest\n```\n\n### 4. Run E2E Tests\n```bash\n# Backend E2E tests (Jest)\ncd apps/backend && npm run test:e2e\n\n# Frontend UI tests (Playwright)\ncd apps/web && playwright test\n```\n\n### 5. Run Integration Tests\n```bash\n# Backend integration tests\ncd apps/backend && npm run test:integration\n```\n\n## Test Creation Guidelines\n\nWhen creating new tests:\n\n1. **Backend (NestJS)**:\n   - Unit tests: Create `*.spec.ts` files alongside source code in `apps/backend/src/modules/`\n   - E2E tests: Add to `apps/backend/tests/e2e/` with `*.e2e-spec.ts` pattern\n   - Playwright API tests: Add to `apps/backend/tests/` with `*.spec.ts` pattern\n\n2. **Frontend (Next.js/Refine)**:\n   - **Unit/Component tests**: Create `*.spec.tsx` files in `src/**/__tests__/` or alongside components\n   - **UI E2E tests**: Create Playwright tests in `apps/web/tests/` with `*.spec.ts` pattern\n   - Test user workflows end-to-end (login, form submission, navigation)\n   - Use React Testing Library for component testing\n\n3. **AI Engine (Python)**:\n   - Unit tests: Add to `apps/ai-engine/tests/unit/` with `test_*.py` pattern\n   - Use pytest fixtures for common test setup\n\n## Frontend Jest Testing\n\n- **Test files**: `src/**/*.spec.tsx` or `src/**/__tests__/**/*.spec.tsx`\n- **Framework**: Jest + React Testing Library\n- **Config**: `apps/web/jest.config.js`\n- **Commands**:\n  - `cd apps/web && npm test` - Run all tests\n  - `cd apps/web && npm run test:watch` - Watch mode\n  - `cd apps/web && npm run test:cov` - With coverage\n\n## E2E Test Persistence for Regression Testing\n\n- All Playwright tests (both frontend and backend) are preserved for regression testing\n- Test files should be named descriptively (e.g., `user-login.spec.ts`, `legal-question-flow.spec.ts`)\n- Before releasing, run full E2E suite to catch regressions\n- E2E tests verify critical user journeys and prevent feature regressions\n\n## Error Handling\n\n- If linting fails: Fix issues immediately before proceeding\n- If type checking fails: Fix type errors before running tests\n- If tests fail: Analyze failures and fix bugs OR update tests if requirements changed\n- Report summary of all validation steps to the user\n\n## Output Format\n\nProvide a clear summary of validation results:\n\n```\n## Validation Summary\n\n### Linting: PASSED/FAILED\n### Type Check: PASSED/FAILED\n### Backend Unit Tests: PASSED/FAILED (X passed, Y failed)\n### Frontend Unit Tests: PASSED/FAILED (X passed, Y failed)\n### E2E Tests: PASSED/FAILED (X passed, Y failed)\n### Integration Tests: PASSED/FAILED (X passed, Y failed)\n### AI Engine Tests: PASSED/FAILED (X passed, Y failed)\n\n[If failures exist, provide details on what needs to be fixed]\n```\n\n## Quick Reference\n\n- **Full validation**: Run all steps 1-5 above\n- **Quick check**: Run lint + typecheck only (steps 1-2)\n- **After each feature**: Always run full validation (steps 1-5)\n- **Before commit**: lint-staged handles this automatically, but manual verification is recommended"
}
