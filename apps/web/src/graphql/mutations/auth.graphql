# Authentication Mutations
# These mutations will be used by GraphQL Code Generator to generate TypeScript types

#import "../fragments/user.graphql"

# Login with email/username and password
mutation Login($input: LoginInput!) {
  login(input: $input) {
    ...AuthPayloadFragment
  }
}

# Register a new user account
mutation Register($input: RegisterInput!) {
  register(input: $input) {
    ...AuthPayloadFragment
  }
}

# Refresh access token using refresh token
mutation RefreshToken($input: RefreshTokenInput!) {
  refreshToken(input: $input) {
    ...RefreshTokenPayloadFragment
  }
}

# Accept the legal disclaimer
mutation AcceptDisclaimer {
  acceptDisclaimer {
    ...AuthUserFragment
  }
}

# Complete two-factor authentication login
mutation CompleteTwoFactorLogin($input: CompleteTwoFactorLoginInput!) {
  completeTwoFactorLogin(input: $input) {
    ...AuthPayloadFragment
  }
}

# Enable two-factor authentication - generates QR code and backup codes
mutation EnableTwoFactorAuth {
  enableTwoFactorAuth {
    secret
    qrCodeDataUrl
    backupCodes
  }
}

# Verify two-factor setup with TOTP token
mutation VerifyTwoFactorSetup($input: VerifyTwoFactorSetupInput!) {
  verifyTwoFactorSetup(input: $input) {
    success
    backupCodes
  }
}

# Disable two-factor authentication with password confirmation
mutation DisableTwoFactorAuth($input: DisableTwoFactorInput!) {
  disableTwoFactorAuth(input: $input)
}

# Regenerate backup codes
mutation RegenerateBackupCodes {
  regenerateBackupCodes {
    codes
  }
}
