<!--
Sync Impact Report:
- Version Change: 1.1.0 -> 1.2.0
- Modified:
  - IV. AI-First Capabilities (Added "Drafting complaints, lawsuits, and other legal pleadings")
- Templates Checked:
  - .specify/templates/plan-template.md (✅ Consistent)
  - .specify/templates/spec-template.md (✅ Consistent)
  - .specify/templates/tasks-template.md (✅ Consistent)
-->

# Legal AI Platform Constitution

## Core Principles

### I. Domain-Driven Design (DDD)

The project MUST be developed using Domain-Driven Design principles. The software model must deeply reflect the legal business domain. We prioritize understanding the domain over technical implementation details in the early stages.

### II. Modular Monolith Architecture

The backend MUST be structured as a Modular Monolith.

- **Strict Boundaries**: Modules must be logically and physically separated.
- **No Direct Imports**: Importing code from one module's domain/infrastructure into another is STRICTLY PROHIBITED.
- **Event-Driven Communication**: Communication between modules MUST happen exclusively via **asynchronous events**.
- **CQRS**: The architecture MUST follow **CQRS** (Command Query Responsibility Segregation). Separate **Read** and **Write** models MUST be used for distinct optimizations. For simplicity same tables and databases are used for now, only model is different (ORM). CQRS should not be forced, used where it matters only.

### III. Defined Technology Stack

We adhere to a strict, modern technology stack:

- **Frontend**: Next.js (UI Framework) + refine.dev (Data Framework). Styling via proper Tailwind CSS and shadcn/ui components.
- **Core Backend**: Nest.js + nestjs-query. GraphQL is the primary API for data operations. Database: PostgreSQL. User Management: Nest.js / WorkOS (AuthKit).
- **AI Service**: Python + FastAPI (HTTP Server). Agent logic using PydanticAI. Agent orchestration using LangGraph.

### IV. AI-First Capabilities

The platform is designed to assist lawyers and regular users by:

- Generating legal documents and answers.
- Drafting complaints, lawsuits, and other legal pleadings.
- Searching rulings and legal bases.
- Using complex agentic workflows (LangGraph).
  AI logic remains distinct in the Python service but deeply integrated via API contracts.

### V. English-First & Semantic Versioning

- **English-First**: All source code, comments, documentation, and commit messages MUST be in **English**.
- **Conventional Commits**: Commit messages MUST follow the [Conventional Commits](https://www.conventionalcommits.org/) specification (e.g., `feat:`, `fix:`, `docs:`).
- **Semantic Release**: Versioning and releases MUST be automated using **semantic-release**, deriving version bumps (Major/Minor/Patch) directly from commit types.
- **Localization**: The frontend MUST be architected to support translation/i18n mechanisms, allowing for Polish (and other languages) support to be added easily later.

### VI. Strong Typing & Code-First Contracts

- **Strong Typing**: The codebase MUST be strongly typed to aim for a sound type system. Usage of `any` (TS) or untyped `Dict`/`Any` (Python) is strictly discouraged.
- **Code-First Schema**: API schemas (GraphQL, OpenAPI) MUST be generated automatically from code definitions (DTOs/Classes). Manual schema files are forbidden.
- **Autogenerated Clients**:
  - **Internal (Service-to-Service)**: Communication (e.g., NestJS ↔ Python) MUST use **REST** with clients **autogenerated** from OpenAPI specs.
  - **Public (Frontend ↔ Backend)**: Frontend clients SHOULD be **autogenerated** from backend schemas (GraphQL Code Generator or similar) wherever possible.

## System Constraints

- **Monorepo Structure**: All components (Client, Server, AI Engine) live in a single repository to facilitate unified versioning and simplified CI/CD.
- **Asynchronous Events**: Synchronous coupling between modules is forbidden to ensure scalability and independent failure domains.

## Quality Assurance

- **Architecture Tests**: CI pipelines MUST include architecture tests (e.g., using ArchUnit equivalent for Node/Python) to fail builds if module import rules are violated.
- **Workflow**: All features follow the specified workflow: Specification -> Planning -> Implementation -> Verification.

## Governance

This Constitution supersedes all other technical preferences or loose guidelines.

- **Amendments**: Changes to principles (especially Architecture and Stack) require a formal amendment to this document and a MAJOR version bump.
- **Compliance**: Every Pull Request Review MUST verify adherence to Modular Monolith boundaries, English language rules, and Conventional Commits.

**Version**: 1.3.0 | **Ratified**: 2025-12-09 | **Last Amended**: 2025-12-10
