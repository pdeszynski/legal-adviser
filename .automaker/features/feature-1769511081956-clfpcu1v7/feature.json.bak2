{
  "category": "Uncategorized",
  "description": "## Parent Task Context (Already Completed)\n\n> **Note:** The following parent task has already been completed. This context is provided to help you understand the background and requirements for this sub-task. Do not re-implement the parent task - focus only on the new sub-task described below.\n\n### AI Engine Streaming Chat Endpoint\n\n**Description:** Create streaming FastAPI endpoint POST /api/v1/qa/ask-stream for real-time AI responses. Implement using Server-Sent Events (SSE) or streaming JSON response. Endpoint should: 1) Accept { question: string, sessionId: string, mode: 'LAWYER'|'SIMPLE' } in request body, 2) Validate JWT from Authorization header via jwt_dependency, 3) Initialize LangGraph workflow with user context, 4) Stream partial responses as tokens are generated (yield from PydanticAI agent), 5) Send events in format: { type: 'token'|'citation'|'error'|'done', content: string, metadata?: any }, 6) Include citations as separate events when available, 7) Send final 'done' event with complete response metadata. Use FastAPI's StreamingResponse with async generator. Handle client disconnection gracefully. Test streaming with curl/Postman before frontend integration.\n\n---\n\n## Task Description\n\nFix 2026-01-27 11:48:52,906 - src.main - DEBUG - Incoming request: POST /api/v1/qa/ask-stream - Headers: {'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '0', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '\"macOS\"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIwZTJiYzgwZS03NjFhLTQ4ODgtOTViZC0yYzQ2NGI0ZjI0MzUiLCJ1c2VybmFtZSI6ImFkbWluIiwiZW1haWwiOiJhZG1pbkByZWZpbmUuZGV2Iiwicm9sZXMiOlsidXNlciJdLCJ0eXBlIjoiYWNjZXNzIiwiaWF0IjoxNzY5NTEwOTE2LCJleHAiOjE3Njk1MTQ1MTZ9.lyASPBLbR07Ko8fbiqeomGB5Jh8DpJXF8llvoa1MrNA', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36', 'sec-ch-ua': '\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Brave\";v=\"144\"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'sec-gpc': '1', 'accept-language': 'pl-PL,pl;q=0.7', 'origin': 'http://localhost:3000', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:3000/', 'accept-encoding': 'gzip, deflate, br, zstd'}\n2026-01-27 11:48:52,969 - src.main - DEBUG - Outgoing response: /api/v1/qa/ask-stream - Status: 422\n      INFO   127.0.0.1:54554 - \"POST /api/v1/qa/ask-stream?question=What+are+the+common+pitfalls+in+a+residential+re",
  "title": "Fix ask-stream endpoint empty request body validation",
  "images": [],
  "imagePaths": [],
  "textFilePaths": [],
  "skipTests": false,
  "model": "claude-opus",
  "thinkingLevel": "none",
  "reasoningEffort": "none",
  "branchName": "streaming-response",
  "priority": 2,
  "planningMode": "skip",
  "requirePlanApproval": false,
  "dependencies": [
    "ai-engine-streaming-endpoint"
  ],
  "workMode": "current",
  "titleGenerating": false,
  "status": "in_progress",
  "id": "feature-1769511081956-clfpcu1v7",
  "descriptionHistory": [
    {
      "description": "## Parent Task Context (Already Completed)\n\n> **Note:** The following parent task has already been completed. This context is provided to help you understand the background and requirements for this sub-task. Do not re-implement the parent task - focus only on the new sub-task described below.\n\n### AI Engine Streaming Chat Endpoint\n\n**Description:** Create streaming FastAPI endpoint POST /api/v1/qa/ask-stream for real-time AI responses. Implement using Server-Sent Events (SSE) or streaming JSON response. Endpoint should: 1) Accept { question: string, sessionId: string, mode: 'LAWYER'|'SIMPLE' } in request body, 2) Validate JWT from Authorization header via jwt_dependency, 3) Initialize LangGraph workflow with user context, 4) Stream partial responses as tokens are generated (yield from PydanticAI agent), 5) Send events in format: { type: 'token'|'citation'|'error'|'done', content: string, metadata?: any }, 6) Include citations as separate events when available, 7) Send final 'done' event with complete response metadata. Use FastAPI's StreamingResponse with async generator. Handle client disconnection gracefully. Test streaming with curl/Postman before frontend integration.\n\n---\n\n## Task Description\n\nFix 2026-01-27 11:48:52,906 - src.main - DEBUG - Incoming request: POST /api/v1/qa/ask-stream - Headers: {'host': 'localhost:8000', 'connection': 'keep-alive', 'content-length': '0', 'pragma': 'no-cache', 'cache-control': 'no-cache', 'sec-ch-ua-platform': '\"macOS\"', 'authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIwZTJiYzgwZS03NjFhLTQ4ODgtOTViZC0yYzQ2NGI0ZjI0MzUiLCJ1c2VybmFtZSI6ImFkbWluIiwiZW1haWwiOiJhZG1pbkByZWZpbmUuZGV2Iiwicm9sZXMiOlsidXNlciJdLCJ0eXBlIjoiYWNjZXNzIiwiaWF0IjoxNzY5NTEwOTE2LCJleHAiOjE3Njk1MTQ1MTZ9.lyASPBLbR07Ko8fbiqeomGB5Jh8DpJXF8llvoa1MrNA', 'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36', 'sec-ch-ua': '\"Not(A:Brand\";v=\"8\", \"Chromium\";v=\"144\", \"Brave\";v=\"144\"', 'content-type': 'application/json', 'sec-ch-ua-mobile': '?0', 'accept': '*/*', 'sec-gpc': '1', 'accept-language': 'pl-PL,pl;q=0.7', 'origin': 'http://localhost:3000', 'sec-fetch-site': 'same-site', 'sec-fetch-mode': 'cors', 'sec-fetch-dest': 'empty', 'referer': 'http://localhost:3000/', 'accept-encoding': 'gzip, deflate, br, zstd'}\n2026-01-27 11:48:52,969 - src.main - DEBUG - Outgoing response: /api/v1/qa/ask-stream - Status: 422\n      INFO   127.0.0.1:54554 - \"POST /api/v1/qa/ask-stream?question=What+are+the+common+pitfalls+in+a+residential+re",
      "timestamp": "2026-01-27T10:51:22.068Z",
      "source": "initial"
    }
  ],
  "startedAt": "2026-01-27T10:51:22.117Z",
  "updatedAt": "2026-01-27T10:51:22.360Z"
}