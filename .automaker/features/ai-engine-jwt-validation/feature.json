{
  "category": "feature",
  "description": "Update existing JWT validation middleware to extract and validate session ID from custom JWT claims. Add session ID to request context for use in AI Engine endpoints. Validate session ID format (UUID v4). Return 400 if session ID is invalid. Include session ID in Langfuse trace metadata.",
  "id": "ai-engine-jwt-validation",
  "title": "AI Engine JWT Validation with Session ID Support",
  "priority": 1,
  "status": "completed",
  "branchName": "streaming-response",
  "descriptionHistory": [
    {
      "description": "Implement JWT validation middleware in FastAPI AI Engine to authenticate users directly. Create: 1) JWT validation function using backend's JWT_SECRET or RS256 public key, 2) FastAPI dependency (jwt_dependency) that extracts and validates Authorization header, 3) User context object with userId, email, roles extracted from token claims, 4) Error handling for expired/invalid tokens returning 401, 5) Integration with existing PydanticAI agents to receive user context. Use same JWT signing key as backend (shared secret or environment variable). Ensure token expiration matches backend settings. Add health check for JWT validation service.",
      "timestamp": "2026-01-27T09:03:50.799Z",
      "source": "initial"
    },
    {
      "description": "Update existing JWT validation middleware to extract and validate session ID from custom JWT claims. Add session ID to request context for use in AI Engine endpoints. Validate session ID format (UUID v4). Return 400 if session ID is invalid. Include session ID in Langfuse trace metadata.",
      "timestamp": "2026-01-27T21:01:05.095Z",
      "source": "edit"
    }
  ],
  "updatedAt": "2026-01-27T09:18:08.632Z"
}